
 [Skip to content](#VPContent) [![](/agoric-logo-red.svg)Agoric Documentation](/)Search`K` Main Navigation Orchestrate[What is Agoric Orchestration?](/guides/orchestration/)[Key Concepts and APIs](/guides/orchestration/key-concepts.html)

Contract Walkthroughs

[Send Anywhere Example](/guides/orchestration/contract-walkthroughs/send-anywhere.html)[Cross-Chain Unbond Example](/guides/orchestration/contract-walkthroughs/cross-chain-unbond.html)

Example Orchestration DApp

[Installation and Deployment](/guides/orchestration/orchestration-basics/installation.html)[Orca Contract walkthrough](/guides/orchestration/orchestration-basics/contract.html)[UI Walkthrough](/guides/orchestration/orchestration-basics/ui.html)[How Orchestration Works](/guides/orchestration/how-orch-works.html)Build[Getting Started](/guides/getting-started/)[Smart Contract Basics](/guides/zoe/contract-basics.html)[UI Component Library](/guides/UIComponentLibrary/)[Building Client Dapps](/guides/getting-started/contract-rpc.html)[Permissioned Contract Deployment](/guides/coreeval/)[Integrating with Agoric Network](/guides/integration/chain-integration.html)[Agoric CLI](/guides/agoric-cli/)[Agoric API Reference](https://agoric-sdk.pages.dev/)[Endo API Reference](https://endojs.github.io/endo/)[ERTP API](/reference/ertp-api/)[Zoe API](/reference/zoe-api/)[Example Zoe Contracts](/guides/zoe/contracts/)[End-to-End Testing](/e2e-testing.html)Learn[What is Agoric?](/what-is-agoric.html)[Agoric Platform](/guides/platform/)[Zoe Smart Contract Framework](/guides/zoe/)[ERTP](/guides/ertp/)[JavaScript Framework](/guides/js-programming/)[Deployed Zoe Contracts](/guides/zoe/actual-contracts/)[Glossary](/glossary/)[Papers](https://agoric.com/papers/)Tutorials[Tutorial: Dapp with Agoric](/guides/getting-started/tutorial/)[dapp-agoric-basics](/guides/getting-started/tutorial-dapp-agoric-basics.html)[UI Tutorial](/guides/getting-started/ui-tutorial/)Support[Agoric](https://agoric.com/)[Discord](https://agoric.com/discord)[Github Discussions (Q&A)](https://github.com/Agoric/agoric-sdk/discussions)[Office Hours](https://github.com/Agoric/agoric-sdk/wiki/Office-Hours)[Twitter](https://twitter.com/agoric)[YouTube](https://www.youtube.com/channel/UCpY91oQLh_Lp0mitdZ5bYWg/)[Github](https://github.com/Agoric/)

Appearance

MenuReturn to top Sidebar Navigation 

Orchestrate
-----------

[What is Agoric Orchestration?](/guides/orchestration/)[Key Concepts and APIs](/guides/orchestration/key-concepts.html)[### Contract Walkthroughs](/guides/orchestration/contract-walkthroughs/)[Send Anywhere Example](/guides/orchestration/contract-walkthroughs/send-anywhere.html)[Cross-Chain Unbond Example](/guides/orchestration/contract-walkthroughs/cross-chain-unbond.html)[### Example Orchestration DApp](/guides/orchestration/orchestration-basics/)[Installation and Deployment](/guides/orchestration/orchestration-basics/installation.html)[Orca Contract walkthrough](/guides/orchestration/orchestration-basics/contract.html)[UI Walkthrough](/guides/orchestration/orchestration-basics/ui.html)[How Orchestration Works](/guides/orchestration/how-orch-works.html)

Build
-----

[### Getting Started](/guides/getting-started/)[Takeaway 1: Starting a Local Chain](/guides/getting-started/explainer-how-to-start-a-local-chain.html)[Takeaway 2: Deploying a Smart Contract](/guides/getting-started/explainer-deploying-a-smart-contact.html)[Takeaway 3: Making an Offer](/guides/getting-started/explainer-how-to-make-an-offer.html)[### Smart Contract Basics](/guides/zoe/contract-basics.html)[Hello World Smart Contract](/guides/zoe/contract-hello.html)[State Smart Contract](/guides/zoe/contract-state.html)[Access Control Smart Contract](/guides/zoe/contract-access-control.html)[Complete Contract Walk-Through](/guides/zoe/contract-walkthru.html)[Durable Contract Details](/guides/zoe/contract-details.html)[Contract Upgrade](/guides/zoe/contract-upgrade.html)[Contract Governance](/guides/governance/)[UI Component Library](/guides/UIComponentLibrary/)[Building Client Dapps](/guides/getting-started/contract-rpc.html)[### Permissioned Contract Deployment](/guides/coreeval/)[Write Code to Deploy a Contract](/guides/coreeval/proposal.html)[Declare Required Capabilities](/guides/coreeval/permissions.html)[Submit Transactions](/guides/coreeval/local-testnet.html)[### Integrating with Agoric Network](/guides/integration/chain-integration.html)[Name Services: agoricNames, namesByAddress, board](/guides/integration/name-services.html)[SubQuery Indexing](/guides/subquery-indexing.html)[### Agoric CLI](/guides/agoric-cli/)[Agoric CLI Reference](/guides/agoric-cli/)[Using agd to make queries and transactions](/guides/agoric-cli/agd-query-tx.html)[Agoric API Reference](https://agoric-sdk.pages.dev/)[Endo API Reference](https://endojs.github.io/endo/)[### ERTP API](/reference/ertp-api/)[ERTP API](/reference/ertp-api/)[Issuer Object](/reference/ertp-api/issuer.html)[Mint Object](/reference/ertp-api/mint.html)[Brand Object](/reference/ertp-api/brand.html)[Purse Object](/reference/ertp-api/purse.html)[Payment Object](/reference/ertp-api/payment.html)[AmountMath Object](/reference/ertp-api/amount-math.html)[ERTP Data Types](/reference/ertp-api/ertp-data-types.html)[### Zoe API](/reference/zoe-api/)[Zoe API](/reference/zoe-api/)[Zoe Service](/reference/zoe-api/zoe.html)[UserSeat Object](/reference/zoe-api/user-seat.html)[Zoe Contract Facet (ZCF)](/reference/zoe-api/zoe-contract-facet.html)[ZCFSeat Object](/reference/zoe-api/zcfseat.html)[ZCFMint Object](/reference/zoe-api/zcfmint.html)[ZoeHelper Functions](/reference/zoe-api/zoe-helpers.html)[Ratio Math Functions](/reference/zoe-api/ratio-math.html)[Zoe Data Types](/reference/zoe-api/zoe-data-types.html)[### Example Zoe Contracts](/guides/zoe/contracts/)[Example Zoe Contracts](/guides/zoe/contracts/)[Oracle Query Contract](/guides/zoe/contracts/oracle.html)[Vault Contract](/guides/zoe/contracts/vault.html)[Loan Contract](/guides/zoe/contracts/loan.html)[Funded Call Spread Contract](/guides/zoe/contracts/fundedCallSpread.html)[Priced Call Spread Contract](/guides/zoe/contracts/pricedCallSpread.html)[Covered Call Contract](/guides/zoe/contracts/covered-call.html)[OTC Desk Contract](/guides/zoe/contracts/otc-desk.html)[ConstantProduct AMM Contract](/guides/zoe/contracts/constantProductAMM.html)[Sell Items Contract](/guides/zoe/contracts/sell-items.html)[Atomic Swap Contract](/guides/zoe/contracts/atomic-swap.html)[Barter Exchange Contract](/guides/zoe/contracts/barter-exchange.html)[Second-Price Auction Contract](/guides/zoe/contracts/second-price-auction.html)[Simple Exchange Contract](/guides/zoe/contracts/simple-exchange.html)[Escrow To Vote Contract](/guides/zoe/contracts/escrow-to-vote.html)[Mint Payments Contract](/guides/zoe/contracts/mint-payments.html)[Mint and Sell NFTs Contract](/guides/zoe/contracts/mint-and-sell-nfts.html)[Use Object Contract](/guides/zoe/contracts/use-obj-example.html)[Automatic Refund Contract](/guides/zoe/contracts/automatic-refund.html)[End-to-End Testing](/e2e-testing.html)

Learn
-----

[What is Agoric?](/what-is-agoric.html)[Agoric Platform](/guides/platform/)[Zoe Smart Contract Framework](/guides/zoe/)[### ERTP](/guides/ertp/)[Amounts, Values, and Brands](/guides/ertp/amounts.html)[AmountMath](/guides/ertp/amount-math.html)[Issuers and Mints](/guides/ertp/issuers-and-mints.html)[Purses and Payments](/guides/ertp/purses-and-payments.html)[JavaScript Framework](/guides/js-programming/)[### Deployed Zoe Contracts](/guides/zoe/actual-contracts/)[PSM Contract](/guides/zoe/actual-contracts/PSM.html)[PriceAuthority Object](/reference/zoe-api/price-authority.html)[Glossary](/glossary/)[Papers](https://agoric.com/papers/)

Tutorials
---------

[Tutorial: Dapp with Agoric](/guides/getting-started/tutorial/)[### dapp-agoric-basics](/guides/getting-started/tutorial-dapp-agoric-basics.html)[Takeaway 1: Sell Concert Tickets Contract Overview](/guides/getting-started/sell-concert-tickets-contract-explainer.html)[Takeaway 2: Swaparoo Contract Overview](/guides/getting-started/swaparoo-how-to-swap-assets-explainer.html)[Takeaway 3: Sending Invitation Payments using an Address](/guides/getting-started/swaparoo-making-a-payment-explainer.html)[### UI Tutorial](/guides/getting-started/ui-tutorial/)[1. Starting](/guides/getting-started/ui-tutorial/starting.html)[2. Agoric Provider](/guides/getting-started/ui-tutorial/agoric-provider.html)[3. Connect Wallet](/guides/getting-started/ui-tutorial/connect-wallet.html)[4. Querying Vstorage](/guides/getting-started/ui-tutorial/querying-vstorage.html)[5. Making an Offer](/guides/getting-started/ui-tutorial/making-an-offer.html)[6. Conclusion](/guides/getting-started/ui-tutorial/conclusion.html)

Support
-------

[Agoric](https://agoric.com/)[Discord](https://agoric.com/discord)[Discussions (Q&A)](https://github.com/Agoric/agoric-sdk/discussions)[Office Hours](https://github.com/Agoric/agoric-sdk/wiki/Office-Hours)[Twitter](https://twitter.com/agoric)[YouTube](https://www.youtube.com/channel/UCpY91oQLh_Lp0mitdZ5bYWg/)[Github](https://github.com/Agoric/)On this page

Contract Governance [​](#contract-governance)
=============================================

To help build systems with a good balance of decentralization and executive control, the Agoric platform includes, in addition to chain-wide governance included in the Cosmos SDK platform, an [@agoric/governance](https://github.com/Agoric/agoric-sdk/blob/master/packages/governance/#readme) package with a flexible architecture supporting 3 main forms of control over a contract:

* **Parameter Governance**: control of parameter values
* **API governance**: capability to invoke particular methods called out by the contract's authors
* **Offer filters**: capability to disable the use of some offers/invitations to deal with emergencies

Governance Package Aims

The emphasis, throughout the design of the governance package, is on ensuring that clients of a contract have visibility into who can make changes, what changes they can make, and what the current state of the controlled values is.

An [Attacker's Guide](https://github.com/Agoric/agoric-sdk/blob/master/packages/governance/docs/AttackGuide.md) explains the assurances that the governance package aims to support.

Parameter Governance [​](#parameter-governance)
-----------------------------------------------

In [Starting a Contract Instance](./../zoe/#starting-a-contract-instance), we saw that contracts are parameterized by *terms*. Parameter governance supports having an authorized party, the *Electorate*, change such parameters while the contract is running.

In [dapp-agoric-basics](https://github.com/Agoric/dapp-agoric-basics), the swaparoo contract has a governed `Fee` amount parameter:

js
```
const paramTypes = harden(
  /** @type {const} */ ({
    Fee: ParamTypes.AMOUNT
  })
);
```

Reusing Contracts for Electorate, Election Manager [​](#reusing-contracts-for-electorate-election-manager)
----------------------------------------------------------------------------------------------------------

This dapp uses the `committee.js` contract from `@agoric/governance` for its electorate. The core eval deployment script starts the swaparoo committee, gets invitations, and sends them to the the smart wallets of the voters. In `test-vote-by-committee.js`, the committee consists of just 1 voter.

![](/assets/gov-param-1.Bu6_nQJB.svg)

Adding Parameter Governance to a Contract [​](#adding-parameter-governance-to-a-contract)
-----------------------------------------------------------------------------------------

Adding parameter governance to a contract consists mainly of using `handleParamGovernance(...)`. We pass it `zcf` so that it can `getTerms()` for initial parameter values, and we pass `paramTypes` to specify governed parameters and their types. `initialPoserInvitation` is necessary to set up replacing the electorate. `storageNode` and `marshaller` are used to [publish values of the parameters to vstorage](./../zoe/pub-to-storage.html).

js
```
import { handleParamGovernance } from '@agoric/governance/src/contractHelper.js';

export const start = async (zcf, privateArgs, baggage) => {
  // ...
  const { publicMixin, makeDurableGovernorFacet, params } =
    await handleParamGovernance(
      zcf,
      privateArgs.initialPoserInvitation,
      paramTypes,
      privateArgs.storageNode,
      privateArgs.marshaller
    );
  // ...
};
```

We get back

* `params`: read-only parameter access. `params.getFee().value` gives us the current value of the `Fee` parameter at any time, for example.
* `publicMixin`: to make the parameter values available via the contract `publicFacet`
* `makeDurableGovernorFacet`: to combine the contract's existing creator facet methods (known as the `limitedCreatorFacet`) with methods for *changing parameter values*.

js
```
export const start = async (zcf, privateArgs, baggage) => {
  // ...
  const publicFacet = Far('Public', {
    makeFirstInvitation,
    ...publicMixin
  });
  const limitedCreatorFacet = Far('Creator', {
    makeCollectFeesInvitation() {
      return makeCollectFeesInvitation(zcf, feeSeat, feeBrand, 'Fee');
    }
  });
  const { governorFacet } = makeDurableGovernorFacet(
    baggage,
    limitedCreatorFacet
  );
  return harden({ publicFacet, creatorFacet: governorFacet });
};
```

Starting a Governed Contract via its Governor [​](#starting-a-governed-contract-via-its-governor)
-------------------------------------------------------------------------------------------------

Changing parameter values is something only the electorate is authorized to do. To enforce this, a governed contract is started by a *contract governor*. The contract governor holds the fully-functional creator facet that includes the capability to change the parameters. The caller that starts the governor gets only the `limitedCreatorFacet`.

![](/assets/gov-param-2.N14SKSui.svg)

*For clarity, some Zoe API details are ommitted from this figure.*

Putting a question via an Election Manager [​](#putting-a-question-via-an-election-manager)
-------------------------------------------------------------------------------------------

An *ElectionManager* is responsible for letting an appropriate party call `addQuestion()`. The `econCommitteeCharter.js` contract from `@agoric/inter-protocol` is sufficiently general to handle most forms of parameter governance, so we reuse it here. Swaparoo core eval deployment likewise starts this contract, asks it for invitations, and sends them to the voters:

![](/assets/gov-param-3.DOZ4Fb6U.svg)

*For clarity, some Zoe API details are ommitted from this figure.*

The committee participant then instructs their smart wallet to redeem the charter invitation to get a capability to put a question using `VoteOnParamChange`, using `v0-accept-charter` to identify this offer:

js
```
test.serial('Voter0 accepts charter, committee invitations', async t => {
  // ...
  await victor.acceptCharterInvitation('v0-accept-charter');
  // ...
});
```

![](/assets/gov-param-4-accept.C6ktWB-f.svg)

To exercises their `VoteOnParamChange` capability, the committee participant makes a [continuing invitation](/glossary/#continuing-invitation-pattern), referring back to `v0-accept-charter` as `charterAcceptOfferId`:

js
```
const makeVoter = (t, wallet, wellKnown) => {
  // ...
  const putQuestion = async (offerId, params, deadline) => {
    const instance = await wellKnown.instance[contractName]; // swaparoo instance handle
    const path = { paramPath: { key: 'governedParams' } };

    /** @type {import('@agoric/inter-protocol/src/econCommitteeCharter.js').ParamChangesOfferArgs} */
    const offerArgs = harden({ deadline, params, instance, path });

    /** @type {import('@agoric/smart-wallet/src/offers.js').OfferSpec} */
    const offer = {
      id: offerId,
      invitationSpec: {
        source: 'continuing',
        previousOffer: NonNullish(charterAcceptOfferId),
        invitationMakerName: 'VoteOnParamChange'
      },
      offerArgs,
      proposal: {}
    };
    return doOffer(offer);
  };
};
```

The `offerArgs` include a deadline and details of the params to change:

js
```
test.serial('vote to change swap fee', async t => {
  // ...
  const targetFee = IST(50n, 100n); // 50 / 100 = 0.5 IST
  const changes = { Fee: targetFee };
  // ...
  const deadline = BigInt(new Date(2024, 6, 1, 9, 10).valueOf() / 1000);
  const result = await victor.putQuestion('proposeToSetFee', changes, deadline);
  t.log('question is posed', result);
  // ...
});
```

Voting on a question [​](#voting-on-a-question)
-----------------------------------------------

The voter likewise executes an offer to accept their invitation to participate in the committee, using `v0-join-committee` to identify this offer:

js
```
test.serial('Voter0 accepts charter, committee invitations', async t => {
  // ...
  await victor.acceptCommitteeInvitation('v0-join-committee', 0);
  // ...
});
```

To exercise their capability to vote, they make a continuing invitation referring back to `v0-join-committee` as `committeeOfferId`:

js
```
const makeVoter = (t, wallet, wellKnown) => {
  // ...
  const vote = async (offerId, details, position) => {
    const chosenPositions = [details.positions[position]];

    /** @type {import('./wallet-tools.js').OfferSpec} */
    const offer = {
      id: offerId,
      invitationSpec: {
        source: 'continuing',
        previousOffer: NonNullish(committeeOfferId),
        invitationMakerName: 'makeVoteInvitation',
        invitationArgs: harden([chosenPositions, details.questionHandle])
      },
      proposal: {}
    };
    return doOffer(offer);
  };
  // ...
};
```

Each question has a unique `questionHandle` object, part of the `details` published to vstorage.

js
```
test.serial('vote to change swap fee', async t => {
  // ...
  const details = await vstorage.get(
    `published.committee.swaparoo.latestQuestion`
  );
  t.is(details.electionType, 'param_change');
  const voteResult = await victor.vote('voteToSetFee', details, 0);
  t.log('victor voted:', voteResult);
  // ...
});
```

Once the deadline is reached, the contract governor is notified that the question carried. It instructs the swaparoo contract to change the fee.

js
```
test.serial('vote to change swap fee', async t => {
  // ...
  const swapPub = E(zoe).getPublicFacet(
    swapPowers.instance.consume[contractName]
  );
  // ...
  const after = await E(swapPub).getAmount('Fee');
  t.deepEqual(after, targetFee);
});
```

The swaparoo contract also publishes its updated parameters to vstorage.

API Governance [​](#api-governance)
-----------------------------------

Just as parameter governance lets an electorate change parameters of a governed contract, API governance lets the electorate exercise contract APIs; in particular: creator facet methods on a governed contract.

For example, in Inter Protocol, the Economic Committee can add and remove oracle operators:

![](/assets/inter-ec-invoke-method.MNLW1ncI.png)

For details, see:

* [dapp-econ-gov](https://github.com/Agoric/dapp-econ-gov)
* `vaultFactory` contract in `@agoric/inter-protocol`

Offer Filters [​](#offer-filters)
---------------------------------

An electorate can instruct a contract to have Zoe filter the offers that will be passed to the ocntract. See

* [zcf.setOfferFilter(strings)](/reference/zoe-api/zoe-contract-facet.html#zcf-setofferfilter-strings).
* [How to add a contract level pause feature? · agoric-sdk · Discussion #8172](https://github.com/Agoric/agoric-sdk/discussions/8172)
 [Help us improve this page!](https://github.com/Agoric/documentation/edit/main/main/guides/governance/index.md)

Last Updated: 

Pager[Previous pageContract Upgrade](/guides/zoe/contract-upgrade.html)[Next pageUI Component Library](/guides/UIComponentLibrary/)

© 2024 Agoric Systems Operating Company. All Rights Reserved.



