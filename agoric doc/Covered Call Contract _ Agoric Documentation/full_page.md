
 [Skip to content](#VPContent) [![](/agoric-logo-red.svg)Agoric Documentation](/)Search`K` Main Navigation Orchestrate[What is Agoric Orchestration?](/guides/orchestration/)[Key Concepts and APIs](/guides/orchestration/key-concepts.html)

Contract Walkthroughs

[Send Anywhere Example](/guides/orchestration/contract-walkthroughs/send-anywhere.html)[Cross-Chain Unbond Example](/guides/orchestration/contract-walkthroughs/cross-chain-unbond.html)

Example Orchestration DApp

[Installation and Deployment](/guides/orchestration/orchestration-basics/installation.html)[Orca Contract walkthrough](/guides/orchestration/orchestration-basics/contract.html)[UI Walkthrough](/guides/orchestration/orchestration-basics/ui.html)[How Orchestration Works](/guides/orchestration/how-orch-works.html)Build[Getting Started](/guides/getting-started/)[Smart Contract Basics](/guides/zoe/contract-basics.html)[UI Component Library](/guides/UIComponentLibrary/)[Building Client Dapps](/guides/getting-started/contract-rpc.html)[Permissioned Contract Deployment](/guides/coreeval/)[Integrating with Agoric Network](/guides/integration/chain-integration.html)[Agoric CLI](/guides/agoric-cli/)[Agoric API Reference](https://agoric-sdk.pages.dev/)[Endo API Reference](https://endojs.github.io/endo/)[ERTP API](/reference/ertp-api/)[Zoe API](/reference/zoe-api/)[Example Zoe Contracts](/guides/zoe/contracts/)[End-to-End Testing](/e2e-testing.html)Learn[What is Agoric?](/what-is-agoric.html)[Agoric Platform](/guides/platform/)[Zoe Smart Contract Framework](/guides/zoe/)[ERTP](/guides/ertp/)[JavaScript Framework](/guides/js-programming/)[Deployed Zoe Contracts](/guides/zoe/actual-contracts/)[Glossary](/glossary/)[Papers](https://agoric.com/papers/)Tutorials[Tutorial: Dapp with Agoric](/guides/getting-started/tutorial/)[dapp-agoric-basics](/guides/getting-started/tutorial-dapp-agoric-basics.html)[UI Tutorial](/guides/getting-started/ui-tutorial/)Support[Agoric](https://agoric.com/)[Discord](https://agoric.com/discord)[Github Discussions (Q&A)](https://github.com/Agoric/agoric-sdk/discussions)[Office Hours](https://github.com/Agoric/agoric-sdk/wiki/Office-Hours)[Twitter](https://twitter.com/agoric)[YouTube](https://www.youtube.com/channel/UCpY91oQLh_Lp0mitdZ5bYWg/)[Github](https://github.com/Agoric/)

Appearance

MenuReturn to top Sidebar Navigation 

Orchestrate
-----------

[What is Agoric Orchestration?](/guides/orchestration/)[Key Concepts and APIs](/guides/orchestration/key-concepts.html)[### Contract Walkthroughs](/guides/orchestration/contract-walkthroughs/)[Send Anywhere Example](/guides/orchestration/contract-walkthroughs/send-anywhere.html)[Cross-Chain Unbond Example](/guides/orchestration/contract-walkthroughs/cross-chain-unbond.html)[### Example Orchestration DApp](/guides/orchestration/orchestration-basics/)[Installation and Deployment](/guides/orchestration/orchestration-basics/installation.html)[Orca Contract walkthrough](/guides/orchestration/orchestration-basics/contract.html)[UI Walkthrough](/guides/orchestration/orchestration-basics/ui.html)[How Orchestration Works](/guides/orchestration/how-orch-works.html)

Build
-----

[### Getting Started](/guides/getting-started/)[Takeaway 1: Starting a Local Chain](/guides/getting-started/explainer-how-to-start-a-local-chain.html)[Takeaway 2: Deploying a Smart Contract](/guides/getting-started/explainer-deploying-a-smart-contact.html)[Takeaway 3: Making an Offer](/guides/getting-started/explainer-how-to-make-an-offer.html)[### Smart Contract Basics](/guides/zoe/contract-basics.html)[Hello World Smart Contract](/guides/zoe/contract-hello.html)[State Smart Contract](/guides/zoe/contract-state.html)[Access Control Smart Contract](/guides/zoe/contract-access-control.html)[Complete Contract Walk-Through](/guides/zoe/contract-walkthru.html)[Durable Contract Details](/guides/zoe/contract-details.html)[Contract Upgrade](/guides/zoe/contract-upgrade.html)[Contract Governance](/guides/governance/)[UI Component Library](/guides/UIComponentLibrary/)[Building Client Dapps](/guides/getting-started/contract-rpc.html)[### Permissioned Contract Deployment](/guides/coreeval/)[Write Code to Deploy a Contract](/guides/coreeval/proposal.html)[Declare Required Capabilities](/guides/coreeval/permissions.html)[Submit Transactions](/guides/coreeval/local-testnet.html)[### Integrating with Agoric Network](/guides/integration/chain-integration.html)[Name Services: agoricNames, namesByAddress, board](/guides/integration/name-services.html)[SubQuery Indexing](/guides/subquery-indexing.html)[### Agoric CLI](/guides/agoric-cli/)[Agoric CLI Reference](/guides/agoric-cli/)[Using agd to make queries and transactions](/guides/agoric-cli/agd-query-tx.html)[Agoric API Reference](https://agoric-sdk.pages.dev/)[Endo API Reference](https://endojs.github.io/endo/)[### ERTP API](/reference/ertp-api/)[ERTP API](/reference/ertp-api/)[Issuer Object](/reference/ertp-api/issuer.html)[Mint Object](/reference/ertp-api/mint.html)[Brand Object](/reference/ertp-api/brand.html)[Purse Object](/reference/ertp-api/purse.html)[Payment Object](/reference/ertp-api/payment.html)[AmountMath Object](/reference/ertp-api/amount-math.html)[ERTP Data Types](/reference/ertp-api/ertp-data-types.html)[### Zoe API](/reference/zoe-api/)[Zoe API](/reference/zoe-api/)[Zoe Service](/reference/zoe-api/zoe.html)[UserSeat Object](/reference/zoe-api/user-seat.html)[Zoe Contract Facet (ZCF)](/reference/zoe-api/zoe-contract-facet.html)[ZCFSeat Object](/reference/zoe-api/zcfseat.html)[ZCFMint Object](/reference/zoe-api/zcfmint.html)[ZoeHelper Functions](/reference/zoe-api/zoe-helpers.html)[Ratio Math Functions](/reference/zoe-api/ratio-math.html)[Zoe Data Types](/reference/zoe-api/zoe-data-types.html)[### Example Zoe Contracts](/guides/zoe/contracts/)[Example Zoe Contracts](/guides/zoe/contracts/)[Oracle Query Contract](/guides/zoe/contracts/oracle.html)[Vault Contract](/guides/zoe/contracts/vault.html)[Loan Contract](/guides/zoe/contracts/loan.html)[Funded Call Spread Contract](/guides/zoe/contracts/fundedCallSpread.html)[Priced Call Spread Contract](/guides/zoe/contracts/pricedCallSpread.html)[Covered Call Contract](/guides/zoe/contracts/covered-call.html)[OTC Desk Contract](/guides/zoe/contracts/otc-desk.html)[ConstantProduct AMM Contract](/guides/zoe/contracts/constantProductAMM.html)[Sell Items Contract](/guides/zoe/contracts/sell-items.html)[Atomic Swap Contract](/guides/zoe/contracts/atomic-swap.html)[Barter Exchange Contract](/guides/zoe/contracts/barter-exchange.html)[Second-Price Auction Contract](/guides/zoe/contracts/second-price-auction.html)[Simple Exchange Contract](/guides/zoe/contracts/simple-exchange.html)[Escrow To Vote Contract](/guides/zoe/contracts/escrow-to-vote.html)[Mint Payments Contract](/guides/zoe/contracts/mint-payments.html)[Mint and Sell NFTs Contract](/guides/zoe/contracts/mint-and-sell-nfts.html)[Use Object Contract](/guides/zoe/contracts/use-obj-example.html)[Automatic Refund Contract](/guides/zoe/contracts/automatic-refund.html)[End-to-End Testing](/e2e-testing.html)

Learn
-----

[What is Agoric?](/what-is-agoric.html)[Agoric Platform](/guides/platform/)[Zoe Smart Contract Framework](/guides/zoe/)[### ERTP](/guides/ertp/)[Amounts, Values, and Brands](/guides/ertp/amounts.html)[AmountMath](/guides/ertp/amount-math.html)[Issuers and Mints](/guides/ertp/issuers-and-mints.html)[Purses and Payments](/guides/ertp/purses-and-payments.html)[JavaScript Framework](/guides/js-programming/)[### Deployed Zoe Contracts](/guides/zoe/actual-contracts/)[PSM Contract](/guides/zoe/actual-contracts/PSM.html)[PriceAuthority Object](/reference/zoe-api/price-authority.html)[Glossary](/glossary/)[Papers](https://agoric.com/papers/)

Tutorials
---------

[Tutorial: Dapp with Agoric](/guides/getting-started/tutorial/)[### dapp-agoric-basics](/guides/getting-started/tutorial-dapp-agoric-basics.html)[Takeaway 1: Sell Concert Tickets Contract Overview](/guides/getting-started/sell-concert-tickets-contract-explainer.html)[Takeaway 2: Swaparoo Contract Overview](/guides/getting-started/swaparoo-how-to-swap-assets-explainer.html)[Takeaway 3: Sending Invitation Payments using an Address](/guides/getting-started/swaparoo-making-a-payment-explainer.html)[### UI Tutorial](/guides/getting-started/ui-tutorial/)[1. Starting](/guides/getting-started/ui-tutorial/starting.html)[2. Agoric Provider](/guides/getting-started/ui-tutorial/agoric-provider.html)[3. Connect Wallet](/guides/getting-started/ui-tutorial/connect-wallet.html)[4. Querying Vstorage](/guides/getting-started/ui-tutorial/querying-vstorage.html)[5. Making an Offer](/guides/getting-started/ui-tutorial/making-an-offer.html)[6. Conclusion](/guides/getting-started/ui-tutorial/conclusion.html)

Support
-------

[Agoric](https://agoric.com/)[Discord](https://agoric.com/discord)[Discussions (Q&A)](https://github.com/Agoric/agoric-sdk/discussions)[Office Hours](https://github.com/Agoric/agoric-sdk/wiki/Office-Hours)[Twitter](https://twitter.com/agoric)[YouTube](https://www.youtube.com/channel/UCpY91oQLh_Lp0mitdZ5bYWg/)[Github](https://github.com/Agoric/)On this page

Covered Call Contract [​](#covered-call-contract)
=================================================

 Zoe v0.24.0. Last updated August 25, 2022. 
##### [View the code on Github](https://github.com/Agoric/agoric-sdk/blob/f29591519809dbadf19db0a26f38704d87429b89/packages/zoe/src/contracts/coveredCall.js) (Last updated: Sep 12, 2020) [​](#view-the-code-on-github-last-updated-sep-12-2020)

##### [View all contracts on Github](https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe/src/contracts) [​](#view-all-contracts-on-github)

The owner of an asset can use a covered call to give someone else the right to buy the asset at a certain price, called the strike price. That right can then be treated as an asset in its own right. This contract creates those derivative rights, and makes it possible for someone else to tell what they would get if they successfully exercise that right. The call option has an expiry date, at which point the contract is cancelled. It is "covered", meaning that the assets it describes is in the seller's possession, and the actual asset will be transferred when the exchange takes place.

In this contract, the expiry date is represented by the deadline at which the owner of the digital asset's offer is cancelled. Therefore, the owner of the digital asset's proposal must have an `exit` of "afterDeadline".

The party that calls `startInstance()` gets an invitation that they can use to deposit assets. When they do so, the offer result is another invitation that serves as the call option. The invitation includes details of the transaction for the benefit of the counter-party. Their assured presence in the invitation allows the recipient of the invitation to verify what has been escrowed: `{ expirationDate, timerAuthority, underlyingAsset, strikePrice }`.

The Contract's API [​](#the-contract-s-api)
-------------------------------------------

A call option is the right (but not the obligation) to buy digital assets at a pre-determined price, called the strike price. This call option is "covered," meaning that the invitation to accept the offer won't be issued until the assets have been put in escrow. This guarantees that the assets can be transferred without relying on the owner of the digital assets to keep their promise later.

The call option has an expiration date, when the opportunity is cancelled. The owner of the digital assets cannot remove the assets from escrow before the expiration date.

The `creatorInvitation` of this contract is an invitation to escrow the underlying assets. The proposal to escrow assets can have any `give` and `want` with any keywords. Any number of assets of different brands can be escrowed under different keywords. The proposal must have an exit condition with the key "afterDeadline":

js
```
{
  give: { ... },
  want: { ... },
  exit: {
    afterDeadline: { deadline: time, timer: chainTimer },
  },
}
```

The deadline serves as the expiration date for the covered call option. After this deadline, if the option has not been exercised, the underlying assets are automatically returned to the creator of the contract as a refund.

After the owner of the digital assets escrows the assets in the initial offer, they receive a seat. The payout for this seat will either be a refund of the underlying assets (as mentioned above) or payments in the amount of the strike price. Zoe's enforcement of offer safety guarantees that the payout is either a refund or payments in the amount of the strike price, regardless of whether the contract is buggy.

The offerResult of the initial seat resolves to the call option itself: an inspectable invitation to buy the underlying assets. The call option invitation has this additional information in the value: `{ expirationDate, timeAuthority, underlyingAssets, strikePrice }`.

The invitation itself can be traded as a valuable digital asset: a covered call option.

The recipient of a covered call option (whether received as a gift, or bought on an exchange or through a contract) can exercise the option before the deadline by using it as an invitation to this contract, paying the strike price and receiving the underlying assets. The recipient of a covered call option can use whatever keywords they wish, as long as they specify that they `give` the strike price as specified in the invitation value, and `want` the underlying assets exactly.

Making A Call Option [​](#making-a-call-option)
-----------------------------------------------

Let's say Alice wants to create a covered call. She creates the first proposal just like she would create the first proposal in the atomic swap. She creates an issuerKeywordRecord to specify the issuers to be used with each keyword.

js
```
const issuerKeywordRecord = harden({
  UnderlyingAsset: moolaIssuer,
  StrikePrice: simoleanIssuer
});

const { creatorInvitation } = await E(zoe).startInstance(
  coveredCallInstallation,
  issuerKeywordRecord
);
```

Then Alice creates a proposal, and escrows the funds she is depositing.

js
```
const threeMoola = AmountMath.make(moolaBrand, 3n);
const aliceProposal = harden({
  give: { UnderlyingAsset: threeMoola },
  want: { StrikePrice: AmountMath.make(simoleanBrand, 7n) },
  exit: { afterDeadline: { deadline: 1599856578n, timer: chainTimer } }
});

const alicePayment = { UnderlyingAsset: aliceMoolaPurse.withdraw(threeMoola) };
```

Alice makes an offer and gets a seat.

js
```
const aliceSeat = await E(zoe).offer(
  creatorInvitation,
  aliceProposal,
  alicePayment
);

const coveredCall = aliceSeat.getOfferResult();
```

The offerResult obtained from the seat is a zoe invitation that serves as the covered call she wants. This invitation is a full ERTP payment and can be escrowed and used in other contracts. For instance, Alice can send it to Bob, who can either exercise the call option or sell it in another contract, say, an atomic swap:

js
```
const invitationIssuer = E(zoe).getInvitationIssuer();
const bobExclOption = await invitationIssuer.claim(coveredCall);
```

Let's imagine that Bob wants to sell the invitation. He can start a swap instance to trade this invitation for bucks.

js
```
const swapIssuerKeywordRecord = harden({
  Asset: invitationIssuer,
  Price: bucksR.issuer
});
const bobSwapSeat = await E(zoe).startInstance(
  swapInstallation,
  swapIssuerKeywordRecord
);
```

Bob specifies that he wants to swap the invitation for 1 buck, and escrows the covered call invitation. In exchange, he gets a swap invitation he can share.

js
```
const bobProposalSwap = harden({
  give: { Asset: invitationIssuer.getAmountOf(bobExclOption) },
  want: { Price: bucks(1) }
});

const bobPayments = harden({ Asset: bobExclOption });
const bobSwapSeat = await E(zoe).offer(
  bobSwapInvitation,
  bobProposalSwap,
  bobPayments
);

const daveSwapInvitation = bobSwapSeat.getOfferResult();
```

Buying An Option [​](#buying-an-option)
---------------------------------------

Another user, let's call him Dave, is looking to buy the option to trade his 7 simoleans for 3 moola, and is willing to pay 1 buck for the option. He is interested in Bob's swap invitation so he checks that this instance matches what he wants. He can check the amount of the invitation to see what contract it is for, and any contract-provided information about what the invitation can be used for.

js
```
const { installation: daveSwapInstall, instance } =
  await E(zoe).getInvitationDetails(daveSwapInvitation);
const daveSwapIssuers = await E(zoe).getIssuers(instance);

// Dave does some checks
assert(daveSwapInstall === swapInstallation, details`wrong installation`);
assert(daveIssuers.Asset === moolaIssuer, details`unexpected Asset issuer`);
assert(daveIssuers.Price === simoleanIssuer, details`unexpected Price issuer`);
```

Dave can safely proceed with the swap because he knows that if Bob has lied about the swap then Dave's offer will be rejected and he will get a refund. Dave escrows his 1 buck with Zoe and forms his proposal.

js
```
const daveSwapProposal = harden({
  want: { Asset: optionAmount },
  give: { Price: bucks(1) }
});

const daveSwapPayments = harden({ Price: daveBucksPayment });

const daveSwapSeat = await E(zoe).offer(
  daveSwapInvitation,
  daveSwapProposal,
  daveSwapPayments
);
```

Exercising the Option [​](#exercising-the-option)
-------------------------------------------------

Now that Dave owns the covered call he can exercise it. He exercises the option by submitting an offer that pays the required exercise price in exchange for the underlying asset:

js
```
const daveOption = await daveSwapSeat.getPayout('Asset');

const daveCoveredCallProposal = harden({
  want: { UnderlyingAsset: AmountMath.make(moolaBrand, 3n) },
  give: { StrikePrice: AmountMath.make(simoleanBrand, 7n) }
});

const daveCoveredCallPayments = harden({
  StrikePrice: daveSimoleanPayment
});

const daveCallSeat = await E(zoe).offer(
  daveOption,
  daveCoveredCallProposal,
  daveCoveredCallPayments
);

const daveMoolaPayout = await daveCallSeat.getPayout('UnderlyingAsset');
await daveMoolaPurse.deposit(daveMoolaPayout);
```
 [Help us improve this page!](https://github.com/Agoric/documentation/edit/main/main/guides/zoe/contracts/covered-call.md)

Last Updated: 

Pager[Previous pagePriced Call Spread Contract](/guides/zoe/contracts/pricedCallSpread.html)[Next pageOTC Desk Contract](/guides/zoe/contracts/otc-desk.html)

© 2024 Agoric Systems Operating Company. All Rights Reserved.



